# Aggregation Distribution Maker

This project is part of the **On Predicting Aggregation** research. The program is meant to take JSON and PCAPNG files respectively generated by the receiver and the sniffer programs, detect the aggregated packets and create an histogram with the distribution of aggregation in the captured stream.

## Getting started

The steps presented below were tested using Ubuntu 18.10.

### Prerequisites

This project requires Python 3, PIP and NPM to set up.  

You will first need to create a virtual environment. If you are on Debian or on Ubuntu, you will need to install the following package:

```bash
apt-get install python3-venv
```

You should now be able to run the script _create_venv.sh_ placed at the root of the project.

```bash
./create_venv.sh
```

A folder named _venv_ containing the python virtual environment should have appeared at the root of the project.  

The next step is optional for the project to execute, but is necessary if you want to be able to export graphs as images. The library used to generate graphs from our data, _Bokeh_, uses _PhantomJS_ to export graphs as PNG files. You will need to install this dependency globally:

```bash
npm install --global phantomjs-prebuilt
```

If there is an error during the installation, try running this command:

```bash
npm install --global phantomjs-prebuilt --unsafe-perm
```

### Input Format

This program accepts two types of files.

1. .PCAP or .PCAPNG files generated by tools like Wireshark. Those files contain the information about packets.

1. .JSON files with the following format:

```json
{
  "timesReceivedInNanoseconds": [
    11919055314339,
    11919055346468,
    11919055352026 
  ]
}
```

### Running the program

You can run the program by executing the script _make_aggregation_dist.sh_ placed at the root of the project. Not that you will need Python 3 installed on your computer.

```bash
./make_aggregation_dist.sh ./test_files/test.json --name my_test
```

You can also directly run the Python script _./src/fr/inria/npw/make_aggregation_dist.py_ by first activating the project's virtual environment and then exporting the paths of this project's root and source folder to the _PYTHONPATH_ variable:

```bash
source ./venv/bin/activate
export PYTHONPATH="$PYTHONPATH:$(pwd):$(pwd)/src"
python3 ./src/fr/inria/npw/make_aggregation_dist.py "$@"
deactivate
```

You can give the argument _--help_ to the program to learn how to use it.

## Authors

* **William Lebel** - *Initial work* - william.leb@hotmail.com

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details